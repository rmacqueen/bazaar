extends ../layout

mixin showTransactions(t_list)
  .transaction-table
    each t, i in t_list
      .request-info(data-id="#{t._id}")
        .panel-container
          a.see-more(data-toggle="collapse", href="#request-collapse-#{t.status}-#{i}", aria-expanded="false", aria-controls="request-collapse")
            .content
              img.img-circle(width=30 src="#{t._creator.profile.picture}")
              span= t._creator.profile.name
              em= t.service_label
            time.timestamp #{moment(t.timeSent).startOf('day').fromNow()}
        .collapse(id="request-collapse-#{t.status}-#{i}")
          if t.status == 'proposed'
            .responses
              button.btn.btn-primary.accept(data-toggle="modal", data-target="#acceptModal") Accept
              button.btn.btn-primary.reject Reject
          else
            .messaging
              .conversation

              form.message-form
                .form-group
                  textarea.text-input(placeholder="Write message" rows=4)
                .form-group
                  button.btn.btn-primary.btn-md#send-button(type="submit") Send message

block content
  include ../partials/acceptModal
  input#csrf_token(type='hidden', name='_csrf', value=_csrf)
  
  .transaction-page
    .row.options
      .col-xs-4.exchange-type.selected Proposed
      .col-xs-4.exchange-type Upcoming
      .col-xs-4.exchange-type Complete


    mixin showTransactions (transactions.proposed)
    mixin showTransactions (transactions.upcoming)
    mixin showTransactions (transactions.complete)

  script(src='/js/transaction.js')